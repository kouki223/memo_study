**./~/リーダブルコード/Note.md**

1. [リーダブルコードとは?](#1-リーダブルコードとは)
2. [表面上の改善](#2-表面上の改善)
3. [ループとロジックの単純化](#3-ループとロジックの単純化)
4. [コードの再構築](#4-コードの再構築)
5. [名前に情報を詰め込む](#5-名前に情報を詰め込む)
6. [誤解されない名前](#6-誤解されない名前)
7. [美しさ](#7-美しさ)
8. [コメントすべきことを知る](#8-コメントすべきことを知る)
9. [コメントは正確で簡潔に](#9-コメントは正確で簡潔に)
10. [制御フローを読みやすくする](#10-制御フローを読みやすくする)
11. [巨大な式を分割する](#11-巨大な式を分割する)
12. [変数と読みやすさ](#12-変数と読みやすさ)
13. [無関係の下位問題を抽出する](#13-無関係の下位問題を抽出する)
14. [一度に 1 つのことを](#14-一度に1つのことを)
15. [コードに思いを込める](#15-コードに思いを込める)
16. [短いコードを書く](#16-短いコードを書く)
17. [テストと読みやすさ](#17-テストと読みやすさ)

# 1. リーダブルコードとは?

- リーダブルなコードとは何だろうか？

  - 端的にまとめると理解しやすく、可能な限り短時間で読み手が理解する事ができるコードである
    - リーダブルコードにおいて、プログラムの量が多いとか、少ないという事が問題なのではなく、他のエンジニアや、６ヶ月後の自分が短時間で理解する事ができるか？を考えてプログラムを書く
      - プログラムは自分だけのものではない

- 言い換え

  - いわば、リーダブルコードは他己評価のようなものであるという事

    - 普段、急に現在の自分について他己評価してと言われてすぐに始める事ができる人は少ないと思う
      - リーダブルコードも同じようなものである
        - 普段から、自分が考えている事ではなく、将来の自分や他人がコードを読んだ時にどのように感じるのか？という観点でプログラムを書く事が出来ていれば良いのだろう

  - リーダブルコードを意識するという事は普段から使っている脳みその種類が変わる
    - プログラマはプログラムが良いか、悪いかを直感的に判断している
      - その直感に従うのではなくこの直感は本当に正しいだろうか？と自分を外から見るような感覚であるという事

# 2. 表面上の改善

- リーダブルなコードを意識する時に重要な要素が 3 つある

  - 変数
  - インデント
  - コメント
    - これら 3 つの要素をリーダブルな状態へ整える事が比較的用意に取り掛かる事ができる事

- これは、プログラム自体の中身を修正するのではなくあくまで見た目の問題
  - 改善とあるように新しく何かを作るのではなく、既存のプログラムを修正する事を想定する

# 3. ループとロジックの単純化

- 表面上の問題からプログラムの深い部分に進む

  - プログラムの本質は何だろうか？
    - プログラムはデータと処理なのであると理解する事ができる
      - データ
        - 不変
          - データに対して処理がある事で順次進行
      - 処理 => 川の流れ
        - 順次進行
          - 言語の実行順序に沿って実行される(上から下に順次実行される)
        - 分岐
          - 条件に応じて処理が変更される
            - 本流から別の流れへ条件によって分岐する
        - 繰り返し
          - 何らかの障害によって川の流れが停滞するが、条件が解決されると流れへ戻る
    - ロジックとループ
      - ロジック => 分岐
      - ループ => 繰り返し処理
        - 順次進行は決まりごとのため、変更する事は出来ない
          - ロジックとループを工夫する事でリーダブルなコードを目指す
            - 逆に言うなれば、ロジックとループがリーダブルではないコードを作り出す犯人だとも言える

- ロジックとループの単純化で目指す事
  - ずばり、精神的な荷物を解消してあげる事が目的であると言える
    - 制御フローと論理式、変数などがコードをリーダブルではなくして真剣に読まないといけないという精神的な荷物を増やすのである
      - これらを単純化する事で精神的な荷物を減らしていく事が目的

# 4. コードの再構成

- プログラムには本質的に解決したい目的がある

  - しかし、プログラムを組んでいる間に本質的な目的とは無関係な下位の問題を解決するコードを記述してしまっている
    - 無関係な下位問題は本質からずれる場合に、関数に切り出す(抽出する)事を行う

- 1 度に 1 つの事を行う

  - コードの中では、1 度の複数の問題を解決しようとしてしまう事が多くある
    - そうではなく、1 度に 1 つの事を行うようにコードを再構成する

- 日本語で綺麗に処理を説明できるようにする
  - 日本語で綺麗に処理を説明する事だけで、コードの再構築がうまくできる事がある
    - 日本語で綺麗に説明する事が出来ないコードはソースコードとして読む時にも綺麗に理解する事が出来ない
      - コンピューターの言葉(アセンブリー)と人間のインターフェースをプログラムが担ってくれているという理解が重要であるという事

## 5. 名前に情報を詰め込む

- リーダブルなコードにするために、名前を見ただけで情報を**数ヶ月後の自分や、他のエンジニアが！！**読みとる事ができるようにする
  - 具体的には
    - 単語の選択
      - 名前をつけるコードの責務をより明確に表すためにカラフルな名前を選択する(シソーラス的なものに頼る)
    - 汎用的な言葉を避ける
      - tempを例にとって考えるとtempには情報が何もない事がわかる
        - 一見、tempは情報を持っているように見えるが、その名前が生存期間が長いものか、短いのか、中身はfileなのか、JSONオブジェクトなのか？
          - 中身がfileならtempにtemp_fileとするだけで、より見やすくなった
      - tempは必要な時に使う
        - 本当に最小限の一時保存が行われる時にのみ使用する事を心がける
    - 具体的な名前を使い抽象的な名前を避ける
      - イテレーターとしてiはループ処理において普段から使われる
        - しかし、複数のイテレーターがある場合には "変数名_i" などという形でイテレーターにも意味を込める
    - 大切な情報を変数へ追加する
    - スコープの大きな変数には長い名前をつける
    - 文字列、アンダースコアに意味を含める

## 6. 誤解されない名前

- 最も良い名前は誤解されない名前であるという事
  - 読み手がその名前を読んだ時に正しく意図を読み取る事ができる(これは現在の自分ではなく、6ヶ月後や前提知識が0の場合の事)
    - 英単語という難しさを解決してくれる考え
      - 上限の限界値
        - max_
        - min_
      - 包含範囲
        - first
        - last
      - 包含/排他
        - begin
        - end
      - ブール値
        - is
        - has
      - 単語に対するユーザー側の期待
        - get()
        - sizze()
          - これらは軽量なメソッドを連想させる

- 本質的に命名はタコ評価である

## 7. 美しさ

- ソースコードを読む時に美しいコードだとよりリーダブルなコードになる
  - 同じ処理は同じ形に
  - コードの列を整理する
  - コードの中での並び順は統一する
    - 1 2 3 => 3 2 1 ではなく、　1 2 3 => 1 2 3 
    - ! " # => # " ! ではなく、! " # => ! " #
      - 同じ並び順は同じように並べる

## 8. コメントすべきことを知る

- コメントすべきではない事とコメントするべき事に分類してコメントを正しく扱う
  - コメントすべきではない事
    - コードを読めばすぐに理解できる事
    - コードの汚さを保管するためのコメント
  - コメントすべき事
    - 読み手の立場になった時に記述したあった方が良いと思う部分
      - 監督的な位置からコメントを記述する
        - 全体を俯瞰する
        - コードが他のやり方ではなくそのやり方でなぜなっているのか？
        - 定数の背景
        - コードの欠陥をTODOやXXXを使って示す

## 9. コメントは正確で簡潔に

- 具体的に必要な事を簡潔に記述する
  - 抽象的な言葉ではなく、具体的な言葉を書く
    - 代名詞を避ける
    - 正確に関数の動作を説明する
      - 正確な日本を使うなど様々な要素がある
    - 例に挙げる入力例は正しいものを選ぶ
      - "-0.654" => -1 <= 負の値が入力された時の挙動を説明したい
        - 目的を明確にする
    - 高レベルでコードの意図を説明する
      - 本質的な意図をコメントへ
    - より多くの意味が詰まっている言葉や表現を活用する
      - コメントはできるだけ簡潔にしたい

## 10. 制御フローを読みやすくする

- 制御フローを読みやすくする
  - 比較
    - 変化する値   => 左側に記述する
    - 変化しない値 => 右側に記述する
  - 条件分岐
    - 肯定的、目立つ、単純
      - これらの処理は最初に行う
        - ネストした処理が少なくなるため直線的にプログラムの進み方が理解できる
  - ループ
    - 早期returnを意識する
      -　ネストした処理は直線的ではない
        - 直線的にプログラムの進みを理解するためにブロックを早く抜ける

## 11. 巨大な式を分割する

- プログラムにおいて、巨大な式はどうしても生まれてしまう
  - その巨大な式を小さく分割して1つ1つを小さくする
- いかに巨大な式を分割するか？
  - 説明変数を使用する
    - 巨大な式の文書化ができる
  - 分割方法
    - 巨大な式の処理を
      - 否定する
      - 反対の処理方法を考える
    - などの方法を使う
      - 理想的には1つの式に条件分岐が複数回出てこないことが利用だろう

## 12. 変数と読みやすさ

- 変数の量とその変数が影響を及ぼ出すブロックの大きさは比例する
  - 不要な変数を削除する
    - 中間結果を保存する変数を削除する
  - 変数のスコープを短くする
  - イミュータブルに変数を扱う

## 13. 無関係の下位問題を抽出する

- インターフェースのメリットを活用する
  - 日々、私達が記述する関数や処理はすでに用意されていないだろうか？
    - 汎用的な処理は分離してプログラムが本質的に解決したい問題に専念させる
      - そのように境界線をはっきりと示すことで輪郭が明確にリーダブルになる

## 14. 一度に 1 つのことを

- 大きなタスクや、読みづらい処理には解決したいタスクがある
  - 大きなタスクを日本語で1つ1つ分解していく
    - 全てを分離すうひつよういはなく、関数などに置き換えることが出来るものを分離する
      - その後に、日本語で段落を作って1つ1つコードに落とし込む

## 15. コードに思いを込める

- デバック時に問題を言葉に出す事をラバーダッキングと呼ぶ
  - 正しく日本語に処理をする事が出来ないのは、そのプログラムをしっかり理解する事が出来ていない、何か問題があるなどがある

## 16. 短いコードを書く

- スターウォーズ：ジェダイの言葉
  - "冒険。　興奮。　ジェダイはそんなものは求めておらん。"

- コードを出来るだけ短く書く
  - インターフェースの良い点を活用して出来るだけコードを記述しない
  - 本当に必要な機能のみを実装する